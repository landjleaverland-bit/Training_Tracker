import{a as G,g as i,q as m,o as k,T as c,b as S,c as $,d as T,s as _,e as L,f as g,u as I}from"./CSJSiKp5.js";import{h as q,a0 as O,a1 as V,a2 as x,a3 as z,a4 as B,a5 as J,I as f,a6 as F,a7 as M,g as D,a8 as E}from"./BqGvmHQq.js";function Z(e,t,r,a){var o=e.__style;if(q||o!==t){var n=G(t);(!q||n!==e.getAttribute("style"))&&(n==null?e.removeAttribute("style"):e.style.cssText=n),e.__style=t}return a}function R(e,t,r=!1){if(e.multiple){if(t==null)return;if(!z(t))return B();for(var a of e.options)a.selected=t.includes(v(a));return}for(a of e.options){var o=v(a);if(J(o,t)){a.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function N(e){var t=new MutationObserver(()=>{R(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),x(()=>{t.disconnect()})}function H(e,t,r=t){var a=new WeakSet,o=!0;O(e,"change",n=>{var y=n?"[selected]":":checked",d;if(e.multiple)d=[].map.call(e.querySelectorAll(y),v);else{var h=e.querySelector(y)??e.querySelector("option:not([disabled])");d=h&&v(h)}r(d),f!==null&&a.add(f)}),V(()=>{var n=t();if(e===document.activeElement){var y=F??f;if(a.has(y))return}if(R(e,n,o),o&&n===void 0){var d=e.querySelector(":checked");d!==null&&(n=v(d),r(n))}e.__value=n,o=!1}),N(e)}function v(e){return"__value"in e?e.__value:e.value}function K(e,t,r=t){var a=new WeakSet;O(e,"input",async o=>{var n=o?e.defaultValue:e.value;if(n=A(e)?C(n):n,r(n),f!==null&&a.add(f),await M(),n!==(n=t())){var y=e.selectionStart,d=e.selectionEnd,h=e.value.length;if(e.value=n??"",d!==null){var U=e.value.length;y===d&&d===h&&U>h?(e.selectionStart=U,e.selectionEnd=U):(e.selectionStart=y,e.selectionEnd=Math.min(d,U))}}}),(q&&e.defaultValue!==e.value||D(t)==null&&e.value)&&(r(A(e)?C(e.value):e.value),f!==null&&a.add(f)),E(()=>{var o=t();if(e===document.activeElement){var n=F??f;if(a.has(n))return}A(e)&&o===C(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function Q(e,t,r=t){O(e,"change",a=>{var o=a?e.defaultChecked:e.checked;r(o)}),(q&&e.defaultChecked!==e.checked||D(t)==null)&&r(e.checked),E(()=>{var a=t();e.checked=!!a})}function A(e){var t=e.type;return t==="number"||t==="range"}function C(e){return e===""?null:+e}function u(e){return console.error("Firestore Error:",e),{ok:!1,error:e instanceof Error?e.message:"Unknown Firestore error"}}function b(e){const t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate?.()?.toISOString()||t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?.toISOString()||t.updatedAt||new Date().toISOString(),date:t.date}}function w(e){const t=i();if(!t)throw new Error("User not authenticated");return $(T,"users",t,e)}function s(e,t){const r=i();if(!r)throw new Error("User not authenticated");return L(T,"users",r,e,t)}function l(e){return JSON.parse(JSON.stringify(e))}function p(e,t,r){const a=r.replace(/[^a-zA-Z0-9]/g,"_");return`${e}_${t.replace(":","-")}_${a}`}async function X(e){try{if(!i())return{ok:!1,error:"User not authenticated"};const r=p(e.date,e.time,e.customLocation||e.location),a=s("Indoor_Climbs",r);return await _(a,{...l(e),activityType:"indoor_climb",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function Y(e,t){try{if(!i())return{ok:!1,error:"User not authenticated"};const a=s("Indoor_Climbs",e);return await I(a,{...l(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function ee(e){try{if(!i())return{ok:!1,error:"User not authenticated"};let r=m(w("Indoor_Climbs"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"indoor_climb"}))}}catch(t){return u(t)}}async function te(e){try{return i()?(await g(s("Indoor_Climbs",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function re(e){try{if(!i())return{ok:!1,error:"User not authenticated"};const r=p(e.date,e.time,`${e.area}_${e.crag}`),a=s("Outdoor_Climbs",r);return await _(a,{...l(e),activityType:"outdoor_climb",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function ae(e,t){try{if(!i())return{ok:!1,error:"User not authenticated"};const a=s("Outdoor_Climbs",e);return await I(a,{...l(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function ne(e){try{if(!i())return{ok:!1,error:"User not authenticated"};let r=m(w("Outdoor_Climbs"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"outdoor_climb"}))}}catch(t){return u(t)}}async function oe(e){try{return i()?(await g(s("Outdoor_Climbs",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function ie(e){try{if(!i())return{ok:!1,error:"User not authenticated"};const r=p(e.date,e.time,"Fingerboarding"),a=s("Fingerboarding",r);return await _(a,{...l(e),activityType:"fingerboarding",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function ue(e){try{if(!i())return{ok:!1,error:"User not authenticated"};let r=m(w("Fingerboarding"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"fingerboarding"}))}}catch(t){return u(t)}}async function ce(e){try{return i()?(await g(s("Fingerboarding",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function se(e){try{if(!i())return{ok:!1,error:"User not authenticated"};const r=p(e.date,e.time,e.customVenue||e.venue),a=s("Competitions",r);return await _(a,{...l(e),activityType:"competition",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function de(e,t){try{if(!i())return{ok:!1,error:"User not authenticated"};const a=s("Competitions",e);return await I(a,{...l(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function fe(e){try{if(!i())return{ok:!1,error:"User not authenticated"};let r=m(w("Competitions"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"competition"}))}}catch(t){return u(t)}}async function le(e){try{return i()?(await g(s("Competitions",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function ye(e){try{if(!i())return{ok:!1,error:"User not authenticated"};const r=p(e.date,e.time,e.name),a=s("Gym_Sessions",r);return await _(a,{...l(e),activityType:"gym_session",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function he(e){try{if(!i())return{ok:!1,error:"User not authenticated"};let r=m(w("Gym_Sessions"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"gym_session"}))}}catch(t){return u(t)}}async function ve(e){try{return i()?(await g(s("Gym_Sessions",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}function me(){return typeof navigator<"u"?navigator.onLine:!0}export{H as a,K as b,Q as c,X as d,re as e,Z as f,he as g,ye as h,N as i,ie as j,se as k,me as l,te as m,ee as n,oe as o,ae as p,ne as q,ve as r,R as s,ce as t,Y as u,ue as v,le as w,fe as x,de as y};
