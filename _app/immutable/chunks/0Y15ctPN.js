import{a as G,g as o,q as m,o as k,T as c,b as S,c as $,d as F,s as _,e as z,f as g,u as w}from"./CSJSiKp5.js";import{h as q,a0 as O,a1 as L,a2 as V,a3 as x,a4 as B,a5 as J,I as l,a6 as T,a7 as M,g as R,a8 as D}from"./BqGvmHQq.js";function Z(e,t,r,a){var i=e.__style;if(q||i!==t){var n=G(t);(!q||n!==e.getAttribute("style"))&&(n==null?e.removeAttribute("style"):e.style.cssText=n),e.__style=t}return a}function E(e,t,r=!1){if(e.multiple){if(t==null)return;if(!x(t))return B();for(var a of e.options)a.selected=t.includes(v(a));return}for(a of e.options){var i=v(a);if(J(i,t)){a.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function N(e){var t=new MutationObserver(()=>{E(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),V(()=>{t.disconnect()})}function H(e,t,r=t){var a=new WeakSet,i=!0;O(e,"change",n=>{var y=n?"[selected]":":checked",d;if(e.multiple)d=[].map.call(e.querySelectorAll(y),v);else{var h=e.querySelector(y)??e.querySelector("option:not([disabled])");d=h&&v(h)}r(d),l!==null&&a.add(l)}),L(()=>{var n=t();if(e===document.activeElement){var y=T??l;if(a.has(y))return}if(E(e,n,i),i&&n===void 0){var d=e.querySelector(":checked");d!==null&&(n=v(d),r(n))}e.__value=n,i=!1}),N(e)}function v(e){return"__value"in e?e.__value:e.value}function K(e,t,r=t){var a=new WeakSet;O(e,"input",async i=>{var n=i?e.defaultValue:e.value;if(n=C(e)?I(n):n,r(n),l!==null&&a.add(l),await M(),n!==(n=t())){var y=e.selectionStart,d=e.selectionEnd,h=e.value.length;if(e.value=n??"",d!==null){var U=e.value.length;y===d&&d===h&&U>h?(e.selectionStart=U,e.selectionEnd=U):(e.selectionStart=y,e.selectionEnd=Math.min(d,U))}}}),(q&&e.defaultValue!==e.value||R(t)==null&&e.value)&&(r(C(e)?I(e.value):e.value),l!==null&&a.add(l)),D(()=>{var i=t();if(e===document.activeElement){var n=T??l;if(a.has(n))return}C(e)&&i===I(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Q(e,t,r=t){O(e,"change",a=>{var i=a?e.defaultChecked:e.checked;r(i)}),(q&&e.defaultChecked!==e.checked||R(t)==null)&&r(e.checked),D(()=>{var a=t();e.checked=!!a})}function C(e){var t=e.type;return t==="number"||t==="range"}function I(e){return e===""?null:+e}function u(e){return console.error("Firestore Error:",e),{ok:!1,error:e instanceof Error?e.message:"Unknown Firestore error"}}function b(e){const t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate?.()?.toISOString()||t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?.toISOString()||t.updatedAt||new Date().toISOString(),date:t.date}}function p(e){const t=o();if(!t)throw new Error("User not authenticated");return $(F,"users",t,e)}function s(e,t){const r=o();if(!r)throw new Error("User not authenticated");return z(F,"users",r,e,t)}function f(e){return JSON.parse(JSON.stringify(e))}function A(e,t,r){const a=r.replace(/[^a-zA-Z0-9]/g,"_");return`${e}_${t.replace(":","-")}_${a}`}async function X(e){try{if(!o())return{ok:!1,error:"User not authenticated"};const r=A(e.date,e.time,e.customLocation||e.location),a=s("Indoor_Climbs",r);return await _(a,{...f(e),activityType:"indoor_climb",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function Y(e,t){try{if(!o())return{ok:!1,error:"User not authenticated"};const a=s("Indoor_Climbs",e);return await w(a,{...f(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function ee(e){try{if(!o())return{ok:!1,error:"User not authenticated"};let r=m(p("Indoor_Climbs"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"indoor_climb"}))}}catch(t){return u(t)}}async function te(e){try{return o()?(await g(s("Indoor_Climbs",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function re(e){try{if(!o())return{ok:!1,error:"User not authenticated"};const r=A(e.date,e.time,`${e.area}_${e.crag}`),a=s("Outdoor_Climbs",r);return await _(a,{...f(e),activityType:"outdoor_climb",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function ae(e,t){try{if(!o())return{ok:!1,error:"User not authenticated"};const a=s("Outdoor_Climbs",e);return await w(a,{...f(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function ne(e){try{if(!o())return{ok:!1,error:"User not authenticated"};let r=m(p("Outdoor_Climbs"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"outdoor_climb"}))}}catch(t){return u(t)}}async function oe(e){try{return o()?(await g(s("Outdoor_Climbs",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function ie(e){try{if(!o())return{ok:!1,error:"User not authenticated"};const r=A(e.date,e.time,"Fingerboarding"),a=s("Fingerboarding",r);return await _(a,{...f(e),activityType:"fingerboarding",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function ue(e,t){try{if(!o())return{ok:!1,error:"User not authenticated"};const a=s("Fingerboarding",e);return await w(a,{...f(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function ce(e){try{if(!o())return{ok:!1,error:"User not authenticated"};let r=m(p("Fingerboarding"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"fingerboarding"}))}}catch(t){return u(t)}}async function se(e){try{return o()?(await g(s("Fingerboarding",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function de(e){try{if(!o())return{ok:!1,error:"User not authenticated"};const r=A(e.date,e.time,e.customVenue||e.venue),a=s("Competitions",r);return await _(a,{...f(e),activityType:"competition",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function fe(e,t){try{if(!o())return{ok:!1,error:"User not authenticated"};const a=s("Competitions",e);return await w(a,{...f(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function le(e){try{if(!o())return{ok:!1,error:"User not authenticated"};let r=m(p("Competitions"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"competition"}))}}catch(t){return u(t)}}async function ye(e){try{return o()?(await g(s("Competitions",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}async function he(e){try{if(!o())return{ok:!1,error:"User not authenticated"};const r=A(e.date,e.time,e.name),a=s("Gym_Sessions",r);return await _(a,{...f(e),activityType:"gym_session",createdAt:c.now(),updatedAt:c.now()},{merge:!0}),{ok:!0,id:r}}catch(t){return u(t)}}async function ve(e,t){try{if(!o())return{ok:!1,error:"User not authenticated"};const a=s("Gym_Sessions",e);return await w(a,{...f(t),updatedAt:c.now()}),{ok:!0}}catch(r){return u(r)}}async function me(e){try{if(!o())return{ok:!1,error:"User not authenticated"};let r=m(p("Gym_Sessions"),k("date","desc"));return{ok:!0,data:(await S(r)).docs.map(n=>({...b(n),activityType:"gym_session"}))}}catch(t){return u(t)}}async function ke(e){try{return o()?(await g(s("Gym_Sessions",e)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(t){return u(t)}}function Se(){return typeof navigator<"u"?navigator.onLine:!0}export{fe as A,H as a,K as b,Q as c,X as d,re as e,Z as f,me as g,he as h,N as i,ie as j,de as k,Se as l,te as m,ee as n,oe as o,ae as p,ne as q,ke as r,E as s,ve as t,Y as u,se as v,ce as w,ue as x,ye as y,le as z};
