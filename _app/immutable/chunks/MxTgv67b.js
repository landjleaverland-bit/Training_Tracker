import{a as G,g as d,d as $,q as T,o as z,w as B,T as v,b as J,u as L,s as N,c as V,f as M,h as U,i as W}from"./CKP4PXTO.js";import{h as g,a7 as O,a8 as j,a9 as Z,aa as H,ab as K,ac as Q,J as u,ad as q,ae as X,k as E,af as F}from"./DiNvu-rR.js";function w(e,t={},o,r){for(var n in o){var a=o[n];t[n]!==a&&(o[n]==null?e.style.removeProperty(n):e.style.setProperty(n,a,r))}}function ae(e,t,o,r){var n=e.__style;if(g||n!==t){var a=G(t,r);(!g||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(w(e,o?.[0],r[0]),w(e,o?.[1],r[1],"important")):w(e,o,r));return r}function P(e,t,o=!1){if(e.multiple){if(t==null)return;if(!H(t))return K();for(var r of e.options)r.selected=t.includes(m(r));return}for(r of e.options){var n=m(r);if(Q(n,t)){r.selected=!0;return}}(!o||t!==void 0)&&(e.selectedIndex=-1)}function Y(e){var t=new MutationObserver(()=>{P(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Z(()=>{t.disconnect()})}function oe(e,t,o=t){var r=new WeakSet,n=!0;O(e,"change",a=>{var s=a?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(s),m);else{var c=e.querySelector(s)??e.querySelector("option:not([disabled])");i=c&&m(c)}o(i),u!==null&&r.add(u)}),j(()=>{var a=t();if(e===document.activeElement){var s=q??u;if(r.has(s))return}if(P(e,a,n),n&&a===void 0){var i=e.querySelector(":checked");i!==null&&(a=m(i),o(a))}e.__value=a,n=!1}),Y(e)}function m(e){return"__value"in e?e.__value:e.value}function ne(e,t,o=t){var r=new WeakSet;O(e,"input",async n=>{var a=n?e.defaultValue:e.value;if(a=I(e)?A(a):a,o(a),u!==null&&r.add(u),await X(),a!==(a=t())){var s=e.selectionStart,i=e.selectionEnd,c=e.value.length;if(e.value=a??"",i!==null){var f=e.value.length;s===i&&i===c&&f>c?(e.selectionStart=f,e.selectionEnd=f):(e.selectionStart=s,e.selectionEnd=Math.min(i,f))}}}),(g&&e.defaultValue!==e.value||E(t)==null&&e.value)&&(o(I(e)?A(e.value):e.value),u!==null&&r.add(u)),F(()=>{var n=t();if(e===document.activeElement){var a=q??u;if(r.has(a))return}I(e)&&n===A(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function ie(e,t,o=t){O(e,"change",r=>{var n=r?e.defaultChecked:e.checked;o(n)}),(g&&e.defaultChecked!==e.checked||E(t)==null)&&o(e.checked),F(()=>{var r=t();e.checked=!!r})}function I(e){var t=e.type;return t==="number"||t==="range"}function A(e){return e===""?null:+e}function l(e){return console.error("Firestore Error:",e),{ok:!1,error:e instanceof Error?e.message:"Unknown Firestore error"}}function x(e){const t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate?.()?.toISOString()||t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?.toISOString()||t.updatedAt||new Date().toISOString(),date:t.date}}function D(e){return JSON.parse(JSON.stringify(e))}function ee(e,t,o){const r=o.replace(/[^a-zA-Z0-9]/g,"_");return`${e}_${t.replace(":","-")}_${r}`}function C(e){const t=d();if(!t)throw new Error("User not authenticated");return M(U,"users",t,e)}function y(e,t){const o=d();if(!o)throw new Error("User not authenticated");return V(U,"users",o,e,t)}function S(e){async function t(a){try{if(!d())return{ok:!1,error:"User not authenticated"};const i=ee(a.date,a.time||"12:00",e.getIdentifier(a)),c=y(e.collectionName,i);return await N(c,{...D(a),activityType:e.activityType,createdAt:v.now(),updatedAt:v.now()},{merge:!0}),{ok:!0,id:i}}catch(s){return l(s)}}async function o(a,s){try{if(!d())return{ok:!1,error:"User not authenticated"};const c=y(e.collectionName,a);return await L(c,{...D(s),updatedAt:v.now()}),{ok:!0}}catch(i){return l(i)}}async function r(a){try{if(!d())return{ok:!1,error:"User not authenticated"};let i=T(C(e.collectionName),z("date","desc"));return a&&(i=T(C(e.collectionName),B("updatedAt",">",v.fromDate(new Date(a))))),{ok:!0,data:(await J(i)).docs.map(R=>({...x(R),activityType:e.activityType}))}}catch(s){return l(s)}}async function n(a){try{return d()?(await $(y(e.collectionName,a)),{ok:!0}):{ok:!1,error:"User not authenticated"}}catch(s){return l(s)}}return{create:t,update:o,get:r,delete:n}}const h=S({collectionName:"Indoor_Climbs",activityType:"indoor_climb",getIdentifier:e=>e.customLocation||e.location}),se=h.create,ce=h.update,ue=h.get,de=h.delete,b=S({collectionName:"Outdoor_Climbs",activityType:"outdoor_climb",getIdentifier:e=>`${e.area}_${e.crag}`}),le=b.create,fe=b.update,ve=b.get,me=b.delete,_=S({collectionName:"Fingerboarding",activityType:"fingerboarding",getIdentifier:()=>"Fingerboarding"}),ye=_.create,Se=_.update,ge=_.get,he=_.delete,k=S({collectionName:"Competitions",activityType:"competition",getIdentifier:e=>e.customVenue||e.venue}),be=k.create,_e=k.update,ke=k.get,pe=k.delete,p=S({collectionName:"Gym_Sessions",activityType:"gym_session",getIdentifier:e=>e.name}),we=p.create,Ie=p.update,Ae=p.get,De=p.delete;function Oe(){return typeof navigator<"u"?navigator.onLine:!0}async function Te(e,t){try{if(!d())return{ok:!1,error:"User not authenticated"};const r=y("Timer_Preferences",e);return await N(r,{...D(t),updatedAt:v.now()},{merge:!0}),{ok:!0}}catch(o){return l(o)}}async function Ce(e){try{if(!d())return{ok:!1,error:"User not authenticated"};const o=y("Timer_Preferences",e),r=await W(o);if(r.exists()){const n=r.data();return{ok:!0,data:{id:r.id,workDuration:n.workDuration,restDuration:n.restDuration,allowOvertime:n.allowOvertime,updatedAt:n.updatedAt?.toDate?.()?.toISOString()||new Date().toISOString()}}}return{ok:!0,data:void 0}}catch(t){return l(t)}}export{ye as A,_e as B,be as C,ne as a,oe as b,me as c,de as d,ve as e,De as f,ue as g,Ae as h,Oe as i,he as j,ge as k,pe as l,ke as m,Y as n,P as o,ie as p,se as q,fe as r,ae as s,le as t,ce as u,Ce as v,Te as w,Ie as x,we as y,Se as z};
